{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/macbook/Downloads/test_ims/src/components/FormModal.tsx"],"sourcesContent":["\"use client\";\n\nimport dynamic from \"next/dynamic\";\nimport Image from \"next/image\";\nimport { JSX, useState } from \"react\";\nimport ExcelJS from \"exceljs\";\n\n\nconst TeacherForm = dynamic(() => import(\"./forms/TeacherForm\"), {\n  loading: () => <h1>Loading...</h1>,\n});\nconst StudentForm = dynamic(() => import(\"./forms/StudentForm\"), {\n  loading: () => <h1>Loading...</h1>,\n});\n\nconst CompanyForm = dynamic(() => import(\"./forms/CompanyForm\"), {\n  loading: () => <h1>Loading...</h1>,\n});\n\nconst forms: {\n  [key: string]: (type: \"create\" | \"update\", data?: any) => JSX.Element;\n} = {\n  teacher: (type, data) => <TeacherForm type={type} data={data} />,\n  student: (type, data) => <StudentForm type={type} data={data} />,\n  company: (type, data) => <CompanyForm type={type} data={data} />\n};\n\nconst FormModal = ({\n  table,\n  type,\n  data,\n  id,\n}: {\n  table:\n    | \"teacher\"\n    | \"student\"\n    | \"company\"\n  type: \"create\" | \"update\" | \"delete\" ;\n  data?: any;\n  id?: number;\n}) => {\n  const size = type === \"create\" ? \"w-8 h-8\" : \"w-7 h-7\";\n  const bgColor =\n    type === \"create\"\n      ? \"bg-Yellow\"\n      : type === \"update\"\n      ? \"bg-Sky\"\n      : \"bg-Purple\";\n\n  const [open, setOpen] = useState(false);\n  const [excelData, setExcelData] = useState<any[]>([]);\n\n  const handleFileUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      const workbook = new ExcelJS.Workbook();\n      const reader = new FileReader();\n  \n      reader.onload = async (e) => {\n        const buffer = e.target?.result as ArrayBuffer;\n        await workbook.xlsx.load(buffer); \n        const worksheet = workbook.worksheets[0];\n        const jsonData: any[] = [];\n  \n        worksheet.eachRow((row, rowIndex) => {\n          if (rowIndex > 1) { \n            const rowData: any = {};\n            row.eachCell((cell, colIndex) => {\n              rowData[`Column${colIndex}`] = cell.value;\n            });\n            jsonData.push(rowData);\n          }\n        });\n  \n        setExcelData(jsonData); \n        console.log(\"Excel Data:\", jsonData); \n      };\n  \n      reader.readAsArrayBuffer(file);\n    }\n  };\n\nconst uploadDataToServer = async () => {\n  try {\n    const response = await fetch(\"/api/upload\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify(excelData), \n    });\n    if (response.ok) {\n      alert(\"Data uploaded successfully!\");\n    } else {\n      alert(\"Failed to upload data.\");\n    }\n  } catch (error) {\n    console.error(\"Error uploading data:\", error);\n  }\n};\n\n\n  const Form = () => {\n    return type === \"delete\" && id ? (\n      <form action=\"\" className=\"p-4 flex flex-col gap-4\">\n        <span className=\"text-center font-medium\">\n          Bạn có chắc muốn xóa tài khoản này{table}?\n        </span>\n        <button className=\"bg-red-700 text-white py-2 px-4 rounded-md border-none w-max self-center\">\n          Xóa\n        </button>\n      </form>\n    ) : type === \"create\" || type === \"update\" ? (\n      <div className=\"p-4 flex flex-col gap-4\">\n        {forms[table](type, data)}\n        {type === \"create\" && (\n          <div className=\"flex flex-col gap-2\">\n            <label htmlFor=\"excel-upload\" className=\"font-medium\">\n              Upload Excel File:\n            </label>\n            <input\n              type=\"file\"\n              id=\"excel-upload\"\n              accept=\".xlsx, .xls\"\n              onChange={handleFileUpload}\n              className=\"border p-2 rounded-md\"\n            />\n            {excelData.length > 0 && (\n            <div className=\"mt-4\">\n              <h3 className=\"font-medium\">Kiểm tra dữ liệu:</h3>\n              <ul className=\"list-disc pl-5\">\n                {excelData.map((row, index) => (\n                  <li key={index}>{JSON.stringify(row)}</li>\n                ))}\n              </ul>\n              {/* Nút Upload */}\n              <button\n                onClick={uploadDataToServer} \n                className=\"mt-4 bg-blue-500 text-white py-2 px-4 rounded-md\"\n              >\n                Đăng lên hệ thống \n              </button>\n            </div>\n          )}\n        </div>\n        )}\n      </div>\n    ) : (\n      \"Form not found!\"\n    );\n  };\n\n  return (\n    <>\n      <button\n        className={`${size} flex items-center justify-center rounded-full ${bgColor}`}\n        onClick={() => setOpen(true)}\n      >\n        <Image src={`/${type}.png`} alt=\"\" width={16} height={16} />\n      </button>\n      {open && (\n        <div className=\"w-screen h-screen absolute left-0 top-0 bg-black bg-opacity-60 z-50 flex items-center justify-center\">\n          <div className=\"bg-white p-4 rounded-md relative w-[90%] md:w-[70%] lg:w-[60%] xl:w-[50%] 2xl:w-[40%]\">\n            <Form />\n            <div\n              className=\"absolute top-4 right-4 cursor-pointer\"\n              onClick={() => setOpen(false)}\n            >\n              <Image src=\"/close.png\" alt=\"\" width={14} height={14} />\n            </div>\n          </div>\n        </div>\n      )}\n    </>\n  );\n};\n\nexport default FormModal;\n"],"names":[],"mappings":"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","debugId":null}}]
}